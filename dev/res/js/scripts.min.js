(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

/* eslint-disable compat/compat */
// Import getData from "./my_components/data";
var url = 'https://private-9d5e37a-testassignment.apiary-mock.com/get-bears';
var list = document.querySelector('.item-wrapper'); // Тело для отрисовки карточек

var checkbox = document.querySelector('.checkbox');
var item = document.querySelector('.reserv');
var btn = document.querySelector('button');
checkbox.addEventListener('change', function () {
  checkbox.checked ? showReserveItem(list, 'reserve') : showAllItem(list);
});
document.addEventListener('click', function (event) {
  if (event.target.matches('.select-box__list label')) {
    var status = event.target.getAttribute('data-filter');

    if (status === 'accept') {
      hideChildrenItem(list);
      showFilterItem(list, 'accept');
    } else if (status === 'reject') {
      hideChildrenItem(list);
      showFilterItem(list, 'reject');
    } else if (status === 'all') {
      hideChildrenItem(list);
      showFilterItem(list, 'all');
    }
  }
}); // Work with btn

document.addEventListener('click', function (event) {
  if (event.target.matches('button')) {
    var button = event.target;
    var itemId = button.parentNode.id;
    var _item = button.parentNode.parentNode;
    var dataFilter = button.parentNode.dataset.filter;
    var acceptLink = "https://private-9d5e37a-testassignment.apiary-mock.com/resolve-bear?id=".concat(itemId);
    var rejectLink = "https://private-9d5e37a-testassignment.apiary-mock.com/reject-bear?id=".concat(itemId);

    if (button.id === 'accept') {
      postData(_item, button, acceptLink, 'accept');
    } else if (button.id === 'reject') {
      postData(_item, button, rejectLink, 'reject');
    }
  }
});
getData(url).then(function (data) {
  return createData(data.results.data);
}).catch(function (err) {
  return console.log(err);
});

function showReserveItem(list, className) {
  for (var i = 0; i < list.children.length; i++) {
    list.children[i].className.includes(className) ? true : list.children[i].style.display = 'none';
  }
}

function changeFilterValue(item, value) {
  item.dataset.filter = value;
}

function hideChildrenItem(items) {
  for (var i = 0; i < items.children.length; i++) {
    hideItem(items.children[i]);
    console.log(items.children[i].childNodes);
  }
}

function hideItem(item) {
  item.style.display = 'none';
}

function showFilterItem(items, filterStatus) {
  for (var i = 0; i < items.children.length; i++) {
    if (items.children[i].getAttribute('data-filter') === filterStatus) {
      showItem(items.children[i], 'flex');
    }
  }
}

function showItem(item, styleValue) {
  item.style.display = styleValue;
}

function showAllItem(list) {
  for (var i = 0; i < list.children.length; i++) {
    list.children[i].style.display = 'flex';
  }
}

function postData(item, button, link, filterValue) {
  fetch(link, {
    method: 'POST'
  }).then(function (res) {
    if (res.status === 200) {
      console.log('Request complete! response:', res);
      console.log('Status code:', res.status);
      hideItem(item);
      hideItem(button.parentNode);
      postData(link, item);
      changeFilterValue(item, filterValue);
    }
  });
}

function getData(url) {
  return fetch(url).then(function (response) {
    return response.json();
  });
} // Create data in dom


function createData(data) {
  for (var i = 0; i < data.length; i++) {
    data[i].in_reserve ? createReserveItem(data, list, i) : createSimpleItem(data, list, i);
  }
}

function createReserveItem(data, element, index) {
  element.innerHTML += "\n  <div data-filter=\"all\" id=\"".concat(data[index].id, "\" class=\"item reserv reserve-bg-color\">\n  <div class=\"item__img img--in-reserve\"><img src=\"").concat(data[index].image_url, "\" alt=\"\"></div>\n  <div class=\"item__title-reserve reserve-title-color\">\u0412 \u0437\u0430\u043F\u043E\u0432\u0435\u0434\u043D\u0438\u043A\u0435</div>\n  <div class=\"item__info reserve-text-color\">\n      <div class=\"item__title\">").concat(data[index].name, "</div>\n      <div class=\"item__type\">").concat(data[index].type, "</div>\n      <div class=\"item__gender\">").concat(data[index].gender, "</div>\n  </div>\n  <div class=\"inner-btn\">\n      <button id=\"accept\" class=\"btn btn-accept\">\u041F\u0440\u0438\u043D\u044F\u0442\u044C</button>\n      <button id=\"reject\" class=\"btn btn-reject reserve-btn-reject-theme\">\u041E\u0442\u043A\u043B\u043E\u043D\u0438\u0442\u044C</button>\n  </div>\n</div>");
}

function createSimpleItem(data, element, index) {
  element.innerHTML += "\n        <div data-filter=\"all\" id=\"".concat(data[index].id, "\" class=\"item\">\n        <div class=\"item__img\"><img src=\"").concat(data[index].image_url, "\" alt=\"\"></div>\n        <div class=\"item__info\">\n            <div class=\"item__title\">").concat(data[index].name, "</div>\n            <div class=\"item__type\">").concat(data[index].type, "</div>\n            <div class=\"item__gender\">").concat(data[index].gender, "</div>\n        </div>\n        <div class=\"inner-btn\">\n            <button id=\"accept\" class=\"btn btn-accept\">\u041F\u0440\u0438\u043D\u044F\u0442\u044C</button>\n            <button id=\"reject\" class=\"btn btn-reject\">\u041E\u0442\u043A\u043B\u043E\u043D\u0438\u0442\u044C</button>\n        </div>\n    </div>");
}

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJkZXYvcmVzL2pzLWRldi9zY3JpcHRzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQTtBQUNBO0FBQ0EsSUFBTSxHQUFHLEdBQUcsa0VBQVo7QUFDQSxJQUFNLElBQUksR0FBRyxRQUFRLENBQUMsYUFBVCxDQUF1QixlQUF2QixDQUFiLEMsQ0FBc0Q7O0FBQ3RELElBQU0sUUFBUSxHQUFHLFFBQVEsQ0FBQyxhQUFULENBQXVCLFdBQXZCLENBQWpCO0FBQ0EsSUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsU0FBdkIsQ0FBYjtBQUNBLElBQU0sR0FBRyxHQUFHLFFBQVEsQ0FBQyxhQUFULENBQXVCLFFBQXZCLENBQVo7QUFFQSxRQUFRLENBQUMsZ0JBQVQsQ0FBMEIsUUFBMUIsRUFBb0MsWUFBTTtBQUN4QyxFQUFBLFFBQVEsQ0FBQyxPQUFULEdBQW1CLGVBQWUsQ0FBQyxJQUFELEVBQU8sU0FBUCxDQUFsQyxHQUFzRCxXQUFXLENBQUMsSUFBRCxDQUFqRTtBQUNELENBRkQ7QUFJQSxRQUFRLENBQUMsZ0JBQVQsQ0FBMEIsT0FBMUIsRUFBbUMsVUFBQyxLQUFELEVBQVc7QUFDNUMsTUFBSSxLQUFLLENBQUMsTUFBTixDQUFhLE9BQWIsQ0FBcUIseUJBQXJCLENBQUosRUFBcUQ7QUFDbkQsUUFBTSxNQUFNLEdBQUcsS0FBSyxDQUFDLE1BQU4sQ0FBYSxZQUFiLENBQTBCLGFBQTFCLENBQWY7O0FBQ0EsUUFBSSxNQUFNLEtBQUssUUFBZixFQUF5QjtBQUN2QixNQUFBLGdCQUFnQixDQUFDLElBQUQsQ0FBaEI7QUFDQSxNQUFBLGNBQWMsQ0FBQyxJQUFELEVBQU8sUUFBUCxDQUFkO0FBQ0QsS0FIRCxNQUdPLElBQUksTUFBTSxLQUFLLFFBQWYsRUFBeUI7QUFDOUIsTUFBQSxnQkFBZ0IsQ0FBQyxJQUFELENBQWhCO0FBQ0EsTUFBQSxjQUFjLENBQUMs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bUMsSUFBSSxDQUFDLEtBQUQsQ0FBSixDQUFZLEVBRC9DLDZFQUV5QyxJQUFJLENBQUMsS0FBRCxDQUFKLENBQVksU0FGckQsNEdBSXFDLElBQUksQ0FBQyxLQUFELENBQUosQ0FBWSxJQUpqRCwyREFLb0MsSUFBSSxDQUFDLEtBQUQsQ0FBSixDQUFZLElBTGhELDZEQU1zQyxJQUFJLENBQUMsS0FBRCxDQUFKLENBQVksTUFObEQ7QUFhRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qIGVzbGludC1kaXNhYmxlIGNvbXBhdC9jb21wYXQgKi9cbi8vIEltcG9ydCBnZXREYXRhIGZyb20gXCIuL215X2NvbXBvbmVudHMvZGF0YVwiO1xuY29uc3QgdXJsID0gJ2h0dHBzOi8vcHJpdmF0ZS05ZDVlMzdhLXRlc3Rhc3NpZ25tZW50LmFwaWFyeS1tb2NrLmNvbS9nZXQtYmVhcnMnO1xuY29uc3QgbGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pdGVtLXdyYXBwZXInKTsgLy8g0KLQtdC70L4g0LTQu9GPINC+0YLRgNC40YHQvtCy0LrQuCDQutCw0YDRgtC+0YfQtdC6XG5jb25zdCBjaGVja2JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGVja2JveCcpO1xuY29uc3QgaXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXNlcnYnKTtcbmNvbnN0IGJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpO1xuXG5jaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7XG4gIGNoZWNrYm94LmNoZWNrZWQgPyBzaG93UmVzZXJ2ZUl0ZW0obGlzdCwgJ3Jlc2VydmUnKSA6IHNob3dBbGxJdGVtKGxpc3QpO1xufSk7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gIGlmIChldmVudC50YXJnZXQubWF0Y2hlcygnLnNlbGVjdC1ib3hfX2xpc3QgbGFiZWwnKSkge1xuICAgIGNvbnN0IHN0YXR1cyA9IGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmlsdGVyJyk7XG4gICAgaWYgKHN0YXR1cyA9PT0gJ2FjY2VwdCcpIHtcbiAgICAgIGhpZGVDaGlsZHJlbkl0ZW0obGlzdCk7XG4gICAgICBzaG93RmlsdGVySXRlbShsaXN0LCAnYWNjZXB0Jyk7XG4gICAgfSBlbHNlIGlmIChzdGF0dXMgPT09ICdyZWplY3QnKSB7XG4gICAgICBoaWRlQ2hpbGRyZW5JdGVtKGxpc3QpO1xuICAgICAgc2hvd0ZpbHRlckl0ZW0obGlzdCwgJ3JlamVjdCcpO1xuICAgIH0gZWxzZSBpZiAoc3RhdHVzID09PSAnYWxsJykge1xuICAgICAgaGlkZUNoaWxkcmVuSXRlbShsaXN0KTtcbiAgICAgIHNob3dGaWx0ZXJJdGVtKGxpc3QsICdhbGwnKTtcbiAgICB9XG4gIH1cbn0pO1xuXG4vLyBXb3JrIHdpdGggYnRuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICBpZiAoZXZlbnQudGFyZ2V0Lm1hdGNoZXMoJ2J1dHRvbicpKSB7XG4gICAgY29uc3QgYnV0dG9uID0gZXZlbnQudGFyZ2V0O1xuICAgIGNvbnN0IGl0ZW1JZCA9IGJ1dHRvbi5wYXJlbnROb2RlLmlkO1xuICAgIGNvbnN0IGl0ZW0gPSBidXR0b24ucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgIGNvbnN0IGRhdGFGaWx0ZXIgPSBidXR0b24ucGFyZW50Tm9kZS5kYXRhc2V0LmZpbHRlcjtcbiAgICBjb25zdCBhY2NlcHRMaW5rID0gYGh0dHBzOi8vcHJpdmF0ZS05ZDVlMzdhLXRlc3Rhc3NpZ25tZW50LmFwaWFyeS1tb2NrLmNvbS9yZXNvbHZlLWJlYXI/aWQ9JHtpdGVtSWR9YDtcbiAgICBjb25zdCByZWplY3RMaW5rID0gYGh0dHBzOi8vcHJpdmF0ZS05ZDVlMzdhLXRlc3Rhc3NpZ25tZW50LmFwaWFyeS1tb2NrLmNvbS9yZWplY3QtYmVhcj9pZD0ke2l0ZW1JZH1gO1xuXG4gICAgaWYgKGJ1dHRvbi5pZCA9PT0gJ2FjY2VwdCcpIHtcbiAgICAgIHBvc3REYXRhKGl0ZW0sIGJ1dHRvbiwgYWNjZXB0TGluaywgJ2FjY2VwdCcpO1xuICAgIH0gZWxzZSBpZiAoYnV0dG9uLmlkID09PSAncmVqZWN0Jykge1xuICAgICAgcG9zdERhdGEoaXRlbSwgYnV0dG9uLCByZWplY3RMaW5rLCAncmVqZWN0Jyk7XG4gICAgfVxuICB9XG59KTtcblxuZ2V0RGF0YSh1cmwpXG4gIC50aGVuKGRhdGEgPT4gY3JlYXRlRGF0YShkYXRhLnJlc3VsdHMuZGF0YSkpXG4gIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSk7XG5cbmZ1bmN0aW9uIHNob3dSZXNlcnZlSXRlbShsaXN0LCBjbGFzc05hbWUpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0LmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgbGlzdC5jaGlsZHJlbltpXS5jbGFzc05hbWUuaW5jbHVkZXMoY2xhc3NOYW1lKVxuICAgICAgPyB0cnVlXG4gICAgICA6IChsaXN0LmNoaWxkcmVuW2ldLnN0eWxlLmRpc3BsYXkgPSAnbm9uZScpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNoYW5nZUZpbHRlclZhbHVlKGl0ZW0sIHZhbHVlKSB7XG4gIGl0ZW0uZGF0YXNldC5maWx0ZXIgPSB2YWx1ZTtcbn1cblxuZnVuY3Rpb24gaGlkZUNoaWxkcmVuSXRlbShpdGVtcykge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgaGlkZUl0ZW0oaXRlbXMuY2hpbGRyZW5baV0pO1xuICAgIGNvbnNvbGUubG9nKGl0ZW1zLmNoaWxkcmVuW2ldLmNoaWxkTm9kZXMpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhpZGVJdGVtKGl0ZW0pIHtcbiAgaXRlbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xufVxuXG5mdW5jdGlvbiBzaG93RmlsdGVySXRlbShpdGVtcywgZmlsdGVyU3RhdHVzKSB7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoaXRlbXMuY2hpbGRyZW5baV0uZ2V0QXR0cmlidXRlKCdkYXRhLWZpbHRlcicpID09PSBmaWx0ZXJTdGF0dXMpIHtcbiAgICAgIHNob3dJdGVtKGl0ZW1zLmNoaWxkcmVuW2ldLCAnZmxleCcpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBzaG93SXRlbShpdGVtLCBzdHlsZVZhbHVlKSB7XG4gIGl0ZW0uc3R5bGUuZGlzcGxheSA9IHN0eWxlVmFsdWU7XG59XG5cbmZ1bmN0aW9uIHNob3dBbGxJdGVtKGxpc3QpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0LmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgbGlzdC5jaGlsZHJlbltpXS5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICB9XG59XG5cbmZ1bmN0aW9uIHBvc3REYXRhKGl0ZW0sIGJ1dHRvbiwgbGluaywgZmlsdGVyVmFsdWUpIHtcbiAgZmV0Y2gobGluaywge1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICB9KS50aGVuKChyZXMpID0+IHtcbiAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICBjb25zb2xlLmxvZygnUmVxdWVzdCBjb21wbGV0ZSEgcmVzcG9uc2U6JywgcmVzKTtcbiAgICAgIGNvbnNvbGUubG9nKCdTdGF0dXMgY29kZTonLCByZXMuc3RhdHVzKTtcbiAgICAgIGhpZGVJdGVtKGl0ZW0pO1xuICAgICAgaGlkZUl0ZW0oYnV0dG9uLnBhcmVudE5vZGUpO1xuICAgICAgcG9zdERhdGEobGluaywgaXRlbSk7XG4gICAgICBjaGFuZ2VGaWx0ZXJWYWx1ZShpdGVtLCBmaWx0ZXJWYWx1ZSk7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gZ2V0RGF0YSh1cmwpIHtcbiAgcmV0dXJuIGZldGNoKHVybCkudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpO1xufVxuXG4vLyBDcmVhdGUgZGF0YSBpbiBkb21cbmZ1bmN0aW9uIGNyZWF0ZURhdGEoZGF0YSkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICBkYXRhW2ldLmluX3Jlc2VydmVcbiAgICAgID8gY3JlYXRlUmVzZXJ2ZUl0ZW0oZGF0YSwgbGlzdCwgaSlcbiAgICAgIDogY3JlYXRlU2ltcGxlSXRlbShkYXRhLCBsaXN0LCBpKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVSZXNlcnZlSXRlbShkYXRhLCBlbGVtZW50LCBpbmRleCkge1xuICBlbGVtZW50LmlubmVySFRNTCArPSBgXG4gIDxkaXYgZGF0YS1maWx0ZXI9XCJhbGxcIiBpZD1cIiR7ZGF0YVtpbmRleF0uaWR9XCIgY2xhc3M9XCJpdGVtIHJlc2VydiByZXNlcnZlLWJnLWNvbG9yXCI+XG4gIDxkaXYgY2xhc3M9XCJpdGVtX19pbWcgaW1nLS1pbi1yZXNlcnZlXCI+PGltZyBzcmM9XCIke2RhdGFbaW5kZXhdLmltYWdlX3VybH1cIiBhbHQ9XCJcIj48L2Rpdj5cbiAgPGRpdiBjbGFzcz1cIml0ZW1fX3RpdGxlLXJlc2VydmUgcmVzZXJ2ZS10aXRsZS1jb2xvclwiPtCSINC30LDQv9C+0LLQtdC00L3QuNC60LU8L2Rpdj5cbiAgPGRpdiBjbGFzcz1cIml0ZW1fX2luZm8gcmVzZXJ2ZS10ZXh0LWNvbG9yXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiaXRlbV9fdGl0bGVcIj4ke2RhdGFbaW5kZXhdLm5hbWV9PC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiaXRlbV9fdHlwZVwiPiR7ZGF0YVtpbmRleF0udHlwZX08L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJpdGVtX19nZW5kZXJcIj4ke2RhdGFbaW5kZXhdLmdlbmRlcn08L2Rpdj5cbiAgPC9kaXY+XG4gIDxkaXYgY2xhc3M9XCJpbm5lci1idG5cIj5cbiAgICAgIDxidXR0b24gaWQ9XCJhY2NlcHRcIiBjbGFzcz1cImJ0biBidG4tYWNjZXB0XCI+0J/RgNC40L3Rj9GC0Yw8L2J1dHRvbj5cbiAgICAgIDxidXR0b24gaWQ9XCJyZWplY3RcIiBjbGFzcz1cImJ0biBidG4tcmVqZWN0IHJlc2VydmUtYnRuLXJlamVjdC10aGVtZVwiPtCe0YLQutC70L7QvdC40YLRjDwvYnV0dG9uPlxuICA8L2Rpdj5cbjwvZGl2PmA7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVNpbXBsZUl0ZW0oZGF0YSwgZWxlbWVudCwgaW5kZXgpIHtcbiAgZWxlbWVudC5pbm5lckhUTUwgKz0gYFxuICAgICAgICA8ZGl2IGRhdGEtZmlsdGVyPVwiYWxsXCIgaWQ9XCIke2RhdGFbaW5kZXhdLmlkfVwiIGNsYXNzPVwiaXRlbVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbV9faW1nXCI+PGltZyBzcmM9XCIke2RhdGFbaW5kZXhdLmltYWdlX3VybH1cIiBhbHQ9XCJcIj48L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW1fX2luZm9cIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtX190aXRsZVwiPiR7ZGF0YVtpbmRleF0ubmFtZX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtX190eXBlXCI+JHtkYXRhW2luZGV4XS50eXBlfTwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW1fX2dlbmRlclwiPiR7ZGF0YVtpbmRleF0uZ2VuZGVyfTwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImlubmVyLWJ0blwiPlxuICAgICAgICAgICAgPGJ1dHRvbiBpZD1cImFjY2VwdFwiIGNsYXNzPVwiYnRuIGJ0bi1hY2NlcHRcIj7Qn9GA0LjQvdGP0YLRjDwvYnV0dG9uPlxuICAgICAgICAgICAgPGJ1dHRvbiBpZD1cInJlamVjdFwiIGNsYXNzPVwiYnRuIGJ0bi1yZWplY3RcIj7QntGC0LrQu9C+0L3QuNGC0Yw8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+YDtcbn1cbiJdfQ==
