(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

/* eslint-disable compat/compat */
var url = 'https://private-9d5e37a-testassignment.apiary-mock.com/get-bears';
var list = document.querySelector('.item-wrapper');
var checkbox = document.querySelector('.checkbox');

function showReserveItem(listItem, className) {
  for (var i = 0; i < list.children.length; i += 1) {
    if (!listItem.children[i].className.includes(className)) {
      listItem.children[i].style.display = 'none';
    }
  }
}

function changeFilterValue(item, value) {
  item.dataset.filter = value;
}

function hideItem(item) {
  item.style.display = 'none';
}

function hideChildrenItem(items) {
  for (var i = 0; i < items.children.length; i += 1) {
    hideItem(items.children[i]);
  }
}

function showItem(item, styleValue) {
  item.style.display = styleValue;
}

function showFilterItem(items, filterStatus) {
  for (var i = 0; i < items.children.length; i += 1) {
    if (items.children[i].getAttribute('data-filter') === filterStatus) {
      showItem(items.children[i], 'flex');
    }
  }
}

function showAllItem(listItem) {
  for (var i = 0; i < listItem.children.length; i += 1) {
    listItem.children[i].style.display = 'flex';
  }
}

function postData(item, button, link, filterValue) {
  fetch(link, {
    method: 'POST'
  }).then(function (res) {
    if (res.status === 200) {
      hideItem(item);
      hideItem(button.parentNode);
      changeFilterValue(item, filterValue);
    }
  });
}

function getData(urlLink) {
  return fetch(urlLink).then(function (response) {
    return response.json();
  });
}

function createReserveItem(data, element, index) {
  element.innerHTML += "\n        <div data-filter=\"all\" id=\"".concat(data[index].id, "\" class=\"item item--reserve\">\n        <div class=\"item__img\"><img src=\"").concat(data[index].image_url, "\" alt=\"\"></div>\n        <div class=\"item__title-reserve\">\u0412 \u0437\u0430\u043F\u043E\u0432\u0435\u0434\u043D\u0438\u043A\u0435</div>\n        <div class=\"item__info\">\n            <div class=\"item__title\">").concat(data[index].name, "</div>\n            <div class=\"item__type\">").concat(data[index].type, "</div>\n            <div class=\"item__gender\">").concat(data[index].gender, "</div>\n        </div>\n        <button id=\"accept\" class=\"btn btn-accept\">\u041F\u0440\u0438\u043D\u044F\u0442\u044C</button>\n        <button id=\"reject\" class=\"btn btn-reject\">\u041E\u0442\u043A\u043B\u043E\u043D\u0438\u0442\u044C</button>\n</div>");
}

function createSimpleItem(data, element, index) {
  element.innerHTML += "\n        <div data-filter=\"all\" id=\"".concat(data[index].id, "\" class=\"item\">\n        <div class=\"item__img\"><img src=\"").concat(data[index].image_url, "\" alt=\"\"></div>\n        <div class=\"item__info\">\n            <div class=\"item__title\">").concat(data[index].name, "</div>\n            <div class=\"item__type\">").concat(data[index].type, "</div>\n            <div class=\"item__gender\">").concat(data[index].gender, "</div>\n        </div>\n        <button id=\"accept\" class=\"btn btn-accept\">\u041F\u0440\u0438\u043D\u044F\u0442\u044C</button>\n        <button id=\"reject\" class=\"btn btn-reject\">\u041E\u0442\u043A\u043B\u043E\u043D\u0438\u0442\u044C</button>\n    </div>");
}

function createData(data) {
  for (var i = 0; i < data.length; i += 1) {
    if (data[i].in_reserve) {
      createReserveItem(data, list, i);
    } else {
      createSimpleItem(data, list, i);
    }
  }
}

checkbox.addEventListener('change', function () {
  if (checkbox.checked) {
    showReserveItem(list, 'reserve');
  } else {
    showAllItem(list);
  }
});

var selectbox = _toConsumableArray(document.querySelectorAll('.select-box__input'));

selectbox.forEach(function (element) {
  return element.addEventListener('change', function () {
    var status = element.value;

    if (status === 'accept') {
      hideChildrenItem(list);
      showFilterItem(list, 'accept');
    } else if (status === 'reject') {
      hideChildrenItem(list);
      showFilterItem(list, 'reject');
    } else if (status === 'all') {
      hideChildrenItem(list);
      showFilterItem(list, 'all');
    }
  });
});
document.addEventListener('click', function (event) {
  if (event.target.matches('button')) {
    var button = event.target;
    var itemId = button.parentNode.id;
    var item = button.parentNode;
    var acceptLink = "https://private-9d5e37a-testassignment.apiary-mock.com/resolve-bear?id=".concat(itemId);
    var rejectLink = "https://private-9d5e37a-testassignment.apiary-mock.com/reject-bear?id=".concat(itemId);

    if (button.id === 'accept') {
      postData(item, button, acceptLink, 'accept');
    } else if (button.id === 'reject') {
      postData(item, button, rejectLink, 'reject');
    }
  }
});
getData(url).then(function (data) {
  return createData(data.results.data);
}).catch(function (err) {
  throw err;
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJkZXYvcmVzL2pzLWRldi9zY3JpcHRzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7QUNBQTtBQUNBLElBQU0sR0FBRyxHQUFHLGtFQUFaO0FBQ0EsSUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsZUFBdkIsQ0FBYjtBQUNBLElBQU0sUUFBUSxHQUFHLFFBQVEsQ0FBQyxhQUFULENBQXVCLFdBQXZCLENBQWpCOztBQUVBLFNBQVMsZUFBVCxDQUF5QixRQUF6QixFQUFtQyxTQUFuQyxFQUE4QztBQUM1QyxPQUFLLElBQUksQ0FBQyxHQUFHLENBQWIsRUFBZ0IsQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFMLENBQWMsTUFBbEMsRUFBMEMsQ0FBQyxJQUFJLENBQS9DLEVBQWtEO0FBQ2hELFFBQUksQ0FBQyxRQUFRLENBQUMsUUFBVCxDQUFrQixDQUFsQixFQUFxQixTQUFyQixDQUErQixRQUEvQixDQUF3QyxTQUF4QyxDQUFMLEVBQXlEO0FBQ3ZELE1BQUEsUUFBUSxDQUFDLFFBQVQsQ0FBa0IsQ0FBbEIsRUFBcUIsS0FBckIsQ0FBMkIsT0FBM0IsR0FBcUMsTUFBckM7QUFDRDtBQUNGO0FBQ0Y7O0FBRUQsU0FBUyxpQkFBVCxDQUEyQixJQUEzQixFQUFpQyxLQUFqQyxFQUF3QztBQUN0QyxFQUFBLElBQUksQ0FBQyxPQUFMLENBQWEsTUFBYixHQUFzQixLQUF0QjtBQUNEOztBQUVELFNBQVMsUUFBVCxDQUFrQixJQUFsQixFQUF3QjtBQUN0QixFQUFBLElBQUksQ0FBQyxLQUFMLENBQVcsT0FBWCxHQUFxQixNQUFyQjtBQUNEOztBQUVELFNBQVMsZ0JBQVQsQ0FBMEIsS0FBMUIsRUFBaUM7QUFDL0IsT0FBSyxJQUFJLENBQUMsR0FBRyxDQUFiLEVBQWdCLENBQUMsR0FBRyxLQUFLLENBQUMsUUFBTixDQUFlLE1BQW5DLEVBQTJDLENB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LGdCQUFnQixDQUFDLElBQUQsQ0FBaEI7QUFDQSxNQUFBLGNBQWMsQ0FBQyxJQUFELEVBQU8sS0FBUCxDQUFkO0FBQ0Q7QUFDRixHQVo0QixDQUFKO0FBQUEsQ0FBekI7QUFjQSxRQUFRLENBQUMsZ0JBQVQsQ0FBMEIsT0FBMUIsRUFBbUMsVUFBQyxLQUFELEVBQVc7QUFDNUMsTUFBSSxLQUFLLENBQUMsTUFBTixDQUFhLE9BQWIsQ0FBcUIsUUFBckIsQ0FBSixFQUFvQztBQUNsQyxRQUFNLE1BQU0sR0FBRyxLQUFLLENBQUMsTUFBckI7QUFDQSxRQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsVUFBUCxDQUFrQixFQUFqQztBQUNBLFFBQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxVQUFwQjtBQUNBLFFBQU0sVUFBVSxvRkFBNkUsTUFBN0UsQ0FBaEI7QUFDQSxRQUFNLFVBQVUsbUZBQTRFLE1BQTVFLENBQWhCOztBQUNBLFFBQUksTUFBTSxDQUFDLEVBQVAsS0FBYyxRQUFsQixFQUE0QjtBQUMxQixNQUFBLFFBQVEsQ0FBQyxJQUFELEVBQU8sTUFBUCxFQUFlLFVBQWYsRUFBMkIsUUFBM0IsQ0FBUjtBQUNELEtBRkQsTUFFTyxJQUFJLE1BQU0sQ0FBQyxFQUFQLEtBQWMsUUFBbEIsRUFBNEI7QUFDakMsTUFBQSxRQUFRLENBQUMsSUFBRCxFQUFPLE1BQVAsRUFBZSxVQUFmLEVBQTJCLFFBQTNCLENBQVI7QUFDRDtBQUNGO0FBQ0YsQ0FiRDtBQWVBLE9BQU8sQ0FBQyxHQUFELENBQVAsQ0FDRyxJQURILENBQ1EsVUFBQSxJQUFJO0FBQUEsU0FBSSxVQUFVLENBQUMsSUFBSSxDQUFDLE9BQUwsQ0FBYSxJQUFkLENBQWQ7QUFBQSxDQURaLEVBRUcsS0FGSCxDQUVTLFVBQUMsR0FBRCxFQUFTO0FBQ2QsUUFBTSxHQUFOO0FBQ0QsQ0FKSCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qIGVzbGludC1kaXNhYmxlIGNvbXBhdC9jb21wYXQgKi9cbmNvbnN0IHVybCA9ICdodHRwczovL3ByaXZhdGUtOWQ1ZTM3YS10ZXN0YXNzaWdubWVudC5hcGlhcnktbW9jay5jb20vZ2V0LWJlYXJzJztcbmNvbnN0IGxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaXRlbS13cmFwcGVyJyk7XG5jb25zdCBjaGVja2JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGVja2JveCcpO1xuXG5mdW5jdGlvbiBzaG93UmVzZXJ2ZUl0ZW0obGlzdEl0ZW0sIGNsYXNzTmFtZSkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QuY2hpbGRyZW4ubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBpZiAoIWxpc3RJdGVtLmNoaWxkcmVuW2ldLmNsYXNzTmFtZS5pbmNsdWRlcyhjbGFzc05hbWUpKSB7XG4gICAgICBsaXN0SXRlbS5jaGlsZHJlbltpXS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBjaGFuZ2VGaWx0ZXJWYWx1ZShpdGVtLCB2YWx1ZSkge1xuICBpdGVtLmRhdGFzZXQuZmlsdGVyID0gdmFsdWU7XG59XG5cbmZ1bmN0aW9uIGhpZGVJdGVtKGl0ZW0pIHtcbiAgaXRlbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xufVxuXG5mdW5jdGlvbiBoaWRlQ2hpbGRyZW5JdGVtKGl0ZW1zKSB7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMuY2hpbGRyZW4ubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBoaWRlSXRlbShpdGVtcy5jaGlsZHJlbltpXSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gc2hvd0l0ZW0oaXRlbSwgc3R5bGVWYWx1ZSkge1xuICBpdGVtLnN0eWxlLmRpc3BsYXkgPSBzdHlsZVZhbHVlO1xufVxuXG5mdW5jdGlvbiBzaG93RmlsdGVySXRlbShpdGVtcywgZmlsdGVyU3RhdHVzKSB7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMuY2hpbGRyZW4ubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBpZiAoaXRlbXMuY2hpbGRyZW5baV0uZ2V0QXR0cmlidXRlKCdkYXRhLWZpbHRlcicpID09PSBmaWx0ZXJTdGF0dXMpIHtcbiAgICAgIHNob3dJdGVtKGl0ZW1zLmNoaWxkcmVuW2ldLCAnZmxleCcpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBzaG93QWxsSXRlbShsaXN0SXRlbSkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RJdGVtLmNoaWxkcmVuLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgbGlzdEl0ZW0uY2hpbGRyZW5baV0uc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgfVxufVxuXG5mdW5jdGlvbiBwb3N0RGF0YShpdGVtLCBidXR0b24sIGxpbmssIGZpbHRlclZhbHVlKSB7XG4gIGZldGNoKGxpbmssIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgaGlkZUl0ZW0oaXRlbSk7XG4gICAgICBoaWRlSXRlbShidXR0b24ucGFyZW50Tm9kZSk7XG4gICAgICBjaGFuZ2VGaWx0ZXJWYWx1ZShpdGVtLCBmaWx0ZXJWYWx1ZSk7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gZ2V0RGF0YSh1cmxMaW5rKSB7XG4gIHJldHVybiBmZXRjaCh1cmxMaW5rKS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVJlc2VydmVJdGVtKGRhdGEsIGVsZW1lbnQsIGluZGV4KSB7XG4gIGVsZW1lbnQuaW5uZXJIVE1MICs9IGBcbiAgICAgICAgPGRpdiBkYXRhLWZpbHRlcj1cImFsbFwiIGlkPVwiJHtkYXRhW2luZGV4XS5pZH1cIiBjbGFzcz1cIml0ZW0gaXRlbS0tcmVzZXJ2ZVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbV9faW1nXCI+PGltZyBzcmM9XCIke2RhdGFbaW5kZXhdLmltYWdlX3VybH1cIiBhbHQ9XCJcIj48L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW1fX3RpdGxlLXJlc2VydmVcIj7QkiDQt9Cw0L/QvtCy0LXQtNC90LjQutC1PC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtX19pbmZvXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbV9fdGl0bGVcIj4ke2RhdGFbaW5kZXhdLm5hbWV9PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbV9fdHlwZVwiPiR7ZGF0YVtpbmRleF0udHlwZX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtX19nZW5kZXJcIj4ke2RhdGFbaW5kZXhdLmdlbmRlcn08L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxidXR0b24gaWQ9XCJhY2NlcHRcIiBjbGFzcz1cImJ0biBidG4tYWNjZXB0XCI+0J/RgNC40L3Rj9GC0Yw8L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvbiBpZD1cInJlamVjdFwiIGNsYXNzPVwiYnRuIGJ0bi1yZWplY3RcIj7QntGC0LrQu9C+0L3QuNGC0Yw8L2J1dHRvbj5cbjwvZGl2PmA7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVNpbXBsZUl0ZW0oZGF0YSwgZWxlbWVudCwgaW5kZXgpIHtcbiAgZWxlbWVudC5pbm5lckhUTUwgKz0gYFxuICAgICAgICA8ZGl2IGRhdGEtZmlsdGVyPVwiYWxsXCIgaWQ9XCIke2RhdGFbaW5kZXhdLmlkfVwiIGNsYXNzPVwiaXRlbVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbV9faW1nXCI+PGltZyBzcmM9XCIke2RhdGFbaW5kZXhdLmltYWdlX3VybH1cIiBhbHQ9XCJcIj48L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW1fX2luZm9cIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtX190aXRsZVwiPiR7ZGF0YVtpbmRleF0ubmFtZX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtX190eXBlXCI+JHtkYXRhW2luZGV4XS50eXBlfTwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW1fX2dlbmRlclwiPiR7ZGF0YVtpbmRleF0uZ2VuZGVyfTwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGJ1dHRvbiBpZD1cImFjY2VwdFwiIGNsYXNzPVwiYnRuIGJ0bi1hY2NlcHRcIj7Qn9GA0LjQvdGP0YLRjDwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uIGlkPVwicmVqZWN0XCIgY2xhc3M9XCJidG4gYnRuLXJlamVjdFwiPtCe0YLQutC70L7QvdC40YLRjDwvYnV0dG9uPlxuICAgIDwvZGl2PmA7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZURhdGEoZGF0YSkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBpZiAoZGF0YVtpXS5pbl9yZXNlcnZlKSB7XG4gICAgICBjcmVhdGVSZXNlcnZlSXRlbShkYXRhLCBsaXN0LCBpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3JlYXRlU2ltcGxlSXRlbShkYXRhLCBsaXN0LCBpKTtcbiAgICB9XG4gIH1cbn1cblxuY2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xuICBpZiAoY2hlY2tib3guY2hlY2tlZCkge1xuICAgIHNob3dSZXNlcnZlSXRlbShsaXN0LCAncmVzZXJ2ZScpO1xuICB9IGVsc2Uge1xuICAgIHNob3dBbGxJdGVtKGxpc3QpO1xuICB9XG59KTtcblxuY29uc3Qgc2VsZWN0Ym94ID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWxlY3QtYm94X19pbnB1dCcpXTtcbnNlbGVjdGJveC5mb3JFYWNoKGVsZW1lbnQgPT4gZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7XG4gIGNvbnN0IHN0YXR1cyA9IGVsZW1lbnQudmFsdWU7XG4gIGlmIChzdGF0dXMgPT09ICdhY2NlcHQnKSB7XG4gICAgaGlkZUNoaWxkcmVuSXRlbShsaXN0KTtcbiAgICBzaG93RmlsdGVySXRlbShsaXN0LCAnYWNjZXB0Jyk7XG4gIH0gZWxzZSBpZiAoc3RhdHVzID09PSAncmVqZWN0Jykge1xuICAgIGhpZGVDaGlsZHJlbkl0ZW0obGlzdCk7XG4gICAgc2hvd0ZpbHRlckl0ZW0obGlzdCwgJ3JlamVjdCcpO1xuICB9IGVsc2UgaWYgKHN0YXR1cyA9PT0gJ2FsbCcpIHtcbiAgICBoaWRlQ2hpbGRyZW5JdGVtKGxpc3QpO1xuICAgIHNob3dGaWx0ZXJJdGVtKGxpc3QsICdhbGwnKTtcbiAgfVxufSkpO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICBpZiAoZXZlbnQudGFyZ2V0Lm1hdGNoZXMoJ2J1dHRvbicpKSB7XG4gICAgY29uc3QgYnV0dG9uID0gZXZlbnQudGFyZ2V0O1xuICAgIGNvbnN0IGl0ZW1JZCA9IGJ1dHRvbi5wYXJlbnROb2RlLmlkO1xuICAgIGNvbnN0IGl0ZW0gPSBidXR0b24ucGFyZW50Tm9kZTtcbiAgICBjb25zdCBhY2NlcHRMaW5rID0gYGh0dHBzOi8vcHJpdmF0ZS05ZDVlMzdhLXRlc3Rhc3NpZ25tZW50LmFwaWFyeS1tb2NrLmNvbS9yZXNvbHZlLWJlYXI/aWQ9JHtpdGVtSWR9YDtcbiAgICBjb25zdCByZWplY3RMaW5rID0gYGh0dHBzOi8vcHJpdmF0ZS05ZDVlMzdhLXRlc3Rhc3NpZ25tZW50LmFwaWFyeS1tb2NrLmNvbS9yZWplY3QtYmVhcj9pZD0ke2l0ZW1JZH1gO1xuICAgIGlmIChidXR0b24uaWQgPT09ICdhY2NlcHQnKSB7XG4gICAgICBwb3N0RGF0YShpdGVtLCBidXR0b24sIGFjY2VwdExpbmssICdhY2NlcHQnKTtcbiAgICB9IGVsc2UgaWYgKGJ1dHRvbi5pZCA9PT0gJ3JlamVjdCcpIHtcbiAgICAgIHBvc3REYXRhKGl0ZW0sIGJ1dHRvbiwgcmVqZWN0TGluaywgJ3JlamVjdCcpO1xuICAgIH1cbiAgfVxufSk7XG5cbmdldERhdGEodXJsKVxuICAudGhlbihkYXRhID0+IGNyZWF0ZURhdGEoZGF0YS5yZXN1bHRzLmRhdGEpKVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIHRocm93IGVycjtcbiAgfSk7XG4iXX0=
